package org.zaproxy.addon.naf.component.exploit

import androidx.compose.runtime.mutableStateOf
import me.d3s34.rfi.RfiExploiter
import org.zaproxy.addon.naf.model.emptyRfiRequest

class RfiTabComponent(
    val rfiExploiter: RfiExploiter
): ExploitTabComponent("RFI") {

    val rfiRequest = mutableStateOf(emptyRfiRequest())
    val lastResponse = mutableStateOf("")

    override suspend fun exploit() {
        lastResponse.value = rfiExploiter.exploit(rfiRequest = rfiRequest.value)
    }

    override suspend fun onClose() {}
}