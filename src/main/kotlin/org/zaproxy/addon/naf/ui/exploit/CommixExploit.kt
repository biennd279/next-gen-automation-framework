package org.zaproxy.addon.naf.ui.exploit

import androidx.compose.foundation.layout.fillMaxWidth
import androidx.compose.material.OutlinedTextField
import androidx.compose.material.Text
import androidx.compose.runtime.Composable
import androidx.compose.runtime.MutableState
import androidx.compose.runtime.State
import androidx.compose.ui.Modifier
import me.d3s34.commix.CommixRequest
import me.d3s34.docker.ContainerAttachClient
import org.zaproxy.addon.naf.ui.wizard.LabelCheckBox

@Composable
fun CommixExploitTab(
    commixRequest: MutableState<CommixRequest>,
    startAttack: () -> Unit,
    shellContent: State<List<String>>,
    onSendCommand: (String) -> Unit,
    status: State<ContainerAttachClient.Status>,
    hasNewLine: MutableState<Boolean>
) {
    ShellTemplate(
        startAttack,
        shellContent,
        onSendCommand,
        hasNewLine,
        status
    ) {
        with(commixRequest) {
            OutlinedTextField(
                value = value.url,
                onValueChange = { value = value.copy(url = it) },
                label = { Text("Target") },
                modifier = Modifier.fillMaxWidth(),
                singleLine = true,
            )

            OutlinedTextField(
                value = value.data ?: "",
                onValueChange = { value = value.copy(data = it) },
                label = { Text("Data") },
                modifier = Modifier.fillMaxWidth(),
            )

            OutlinedTextField(
                value = value.cookies ?: "",
                onValueChange = { value = value.copy(cookies = it) },
                label = { Text("Cookies") },
                modifier = Modifier.fillMaxWidth(),
            )

            LabelCheckBox(
                checkedState = value.randomAgent,
                onCheckedChange = {
                    value = value.copy(randomAgent = it)
                },
                text = "Random Agent"
            )
        }
    }
}
